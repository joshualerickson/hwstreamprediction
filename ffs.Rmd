---
title: "FFS RF"
author: "Josh Erickson"
date: "April 14, 2020"
output: html_document
---

```{r setup, include=FALSE}

library(caret)
library(CAST)
library(randomForest)
```

#### FFS Random Forest

So with the FFS we will just use the default parameters for Random Forest (e.g. mtry = 2, 4, 6 and ntrees = 500)
```{r, eval=FALSE}


predictorsRF <- trainsel[,c("twi30agg","tpi30agg","accum30","vv30agg", "vvsd30agg","npol30agg","ndvi30yrRS", "ndvias30agg", "ndwias30agg","nppmmid30agg","deficitRS","cad30RS","decid30RS","cpg30precip", "B2_30agg","B4_30agg","B8_30agg")]

responseRF <- trainsel$stream

```


*FFS Kmeans Random Forest*

```{r eval=FALSE}
#bring in cores
cluster <- makeCluster(detectCores() - 1) # convention to leave 1 core for OS
registerDoParallel(cluster)

#set up control
ctrlKrf <- trainControl(method="repeatedcv",
                     repeats = 5,number = 10,
                     allowParallel = TRUE,
                     returnResamp = "all", 
                     verbose = FALSE, 
                     classProbs = TRUE,
                     summaryFunction = fourStats,
                     savePredictions = 'all',
                     index = indicesKsel$index)
#run
set.seed(1234)
ffsKrf.hw <- ffs(predictorsRF,responseRF, 
  metric = "ROC",
  method = "rf",
  trControl = ctrlKrf)


#now remove cluster. consistency...
stopCluster(cluster)
registerDoSEQ()
```


